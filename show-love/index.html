<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡¨ç™½</title>
    <style>
    /* å‹ç¼©å’Œä¼˜åŒ–CSS */
    body{font-family:Arial,sans-serif;font-size:16px;line-height:1.5;margin:0;padding:0;width:100%;height:100%;background-color:#e7e7d8;overflow:hidden}
    #container{width:100%;height:100vh;display:flex;justify-content:center;align-items:center;flex-direction:column}
    .button_group{text-align:center;margin-top:10px;position:relative}
    .but_common{border:none;border-radius:8px;width:65px;height:30px;color:#fff;font-size:14px}
    .but_common:hover{cursor:pointer}
    #but_yes{background-color:#e66ac0}
    #but_no{background-color:#6590ee}
    #loading-tips{font-weight: bold;}
    .music-control{position:fixed;right:20px;top:20px;width:40px;height:40px;border-radius:50%;background-color:rgba(255,255,255,.7);display:flex;justify-content:center;align-items:center;cursor:pointer;z-index:100;box-shadow:0 2px 5px rgba(0,0,0,.2)}
    .music-icon{font-style:normal;font-size:20px}
    .effects-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10}
    .heart{position:absolute;width:30px;height:30px;bottom:-30px;background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path fill='%23ff5a8e' d='M25 39.7l-.6-.5C11.5 28.7 8 25 8 19c0-5 4-9 9-9 4.1 0 6.4 2.3 8 4.1 1.6-1.8 3.9-4.1 8-4.1 5 0 9 4 9 9 0 6-3.5 9.7-16.4 20.2l-.6.5z'/></svg>");background-size:contain;background-repeat:no-repeat;animation:float-up 5s linear infinite}
    .firework{position:absolute;width:10px;height:10px;background-color:white;border-radius:50%;animation:rise 1s ease-out;z-index:9;box-shadow:0 0 10px white}
    .special-firework{animation:special-rise 1.2s ease-out;z-index:20;box-shadow:0 0 20px #ff5a8e,0 0 40px #ff5a8e}
    .particle{position:absolute;width:6px;height:6px;background-color:var(--particle-color,#ff5a8e);border-radius:50%;animation:explode 2s ease-out forwards;z-index:9;box-shadow:0 0 5px var(--particle-color,#ff5a8e)}
    .special-particle{position:absolute;width:8px;height:8px;border-radius:50%;animation:special-explode 3s cubic-bezier(.11,.67,.43,.98) forwards;z-index:20;box-shadow:0 0 10px currentColor}
    .flash{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,.6);z-index:19;animation:flash .8s ease-out forwards;pointer-events:none}
    .message-container{position:fixed;top:40%;left:50%;transform:translate(-50%,-50%);font-size:36px;font-weight:bold;color:#ff5a8e;text-shadow:0 0 10px rgba(255,90,142,.8);z-index:30;text-align:center;opacity:0;animation:message-appear 4s ease-out forwards;pointer-events:none;padding:20px;background-color:rgba(255,255,255,.2);border-radius:10px;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);transition:opacity 1s ease}
    .custom-dialog{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);justify-content:center;align-items:center;z-index:1000}
    .dialog-content{background-color:white;padding:30px;border-radius:15px;box-shadow:0 0 20px rgba(0,0,0,.3);text-align:center;max-width:80%;animation:dialog-appear .3s ease-out forwards;background:linear-gradient(135deg,#fce4ec,#f8bbd0);border:2px solid #f06292}
    .dialog-message{font-size:22px;margin-bottom:20px;color:#e91e63;font-weight:bold}
    .dialog-button{background-color:#e91e63;color:white;border:none;padding:10px 25px;border-radius:25px;cursor:pointer;font-size:16px;transition:background-color .3s}
    .dialog-button:hover{background-color:#c2185b}
    @keyframes float-up{0%{transform:translateY(0) scale(.2) rotate(0deg);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-100vh) scale(1) rotate(360deg);opacity:0}}
    @keyframes rise{0%{transform:translateY(100vh);opacity:0}50%{opacity:1}100%{transform:translateY(0);opacity:0}}
    @keyframes special-rise{0%{transform:translateY(100vh) scale(.5);opacity:0}50%{opacity:1}90%{transform:translateY(0) scale(1.5);opacity:1}100%{transform:translateY(0) scale(2);opacity:0}}
    @keyframes explode{0%{transform:rotate(var(--angle,0deg)) translateX(0);opacity:1}100%{transform:rotate(var(--angle,0deg)) translateX(100px);opacity:0}}
    @keyframes special-explode{0%{transform:rotate(var(--angle,0deg)) translateX(0);opacity:1}70%{opacity:1}100%{transform:rotate(var(--angle,0deg)) translateX(var(--distance,200px));opacity:0}}
    @keyframes flash{0%{opacity:1}100%{opacity:0}}
    @keyframes message-appear{0%{opacity:0;transform:translate(-50%,-50%) scale(.5)}20%{opacity:1;transform:translate(-50%,-50%) scale(1.1)}30%{transform:translate(-50%,-50%) scale(1)}90%{opacity:1}100%{opacity:1}}
    @keyframes dialog-appear{0%{transform:scale(.7);opacity:0}100%{transform:scale(1);opacity:1}}
    
    /* åŠ è½½åŠ¨ç”»æ ·å¼ */
    #loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#e7e7d8;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;transition:opacity 0.5s ease-out}
    .loading-heart{width:80px;height:80px;position:relative;animation:loading-heart-beat 1.2s infinite}
    .loading-heart:before,.loading-heart:after{content:"";background-color:#ff5a8e;width:40px;height:60px;border-radius:40px 40px 0 0;position:absolute;top:0}
    .loading-heart:before{transform:rotate(-45deg);transform-origin:100% 100%;left:20px}
    .loading-heart:after{transform:rotate(45deg);transform-origin:0% 100%;right:20px}
    .loading-text{font-size:24px;font-weight:bold;color:#e66ac0;margin-top:40px;letter-spacing:1px;position:relative}
    .loading-dots{display:inline-block;width:70px}
    .loading-dot{display:inline-block;opacity:0;animation:loading-dot-appear 1.8s infinite;margin:0 2px;font-size:24px;color:#e66ac0}
    .loading-dot:nth-child(2){animation-delay:0.6s}
    .loading-dot:nth-child(3){animation-delay=1.2s}
    .loading-progress{width:200px;height:6px;background-color:rgba(255,255,255,0.5);border-radius:10px;margin-top:20px;overflow:hidden;position:relative}
    .loading-progress-bar{width:0%;height:100%;background:linear-gradient(90deg,#ff5a8e,#e66ac0);border-radius:10px;position:absolute;transition:width 0.3s ease-out}
    .loading-tips{margin-top:20px;font-size:14px;color:#666;text-align:center;max-width:80%;font-style:italic}
    @keyframes loading-heart-beat{0%{transform:scale(0.8)}50%{transform:scale(1)}100%{transform:scale(0.8)}}
    @keyframes loading-dot-appear{0%,100%{opacity:0}50%{opacity:1}}
    </style>
    <!-- æ·»åŠ æƒ…ä¹¦åŠ¨ç”»ç›¸å…³èµ„æº -->
    <link type="text/css" rel="stylesheet" href="./Love_files/default.css">
    <script type="text/javascript" src="./Love_files/jquery.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-parser.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-jit.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-builderbase.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async-powerpack.min.js"></script>
    <script type="text/javascript" src="./Love_files/functions.js" charset="utf-8"></script>
    <script type="text/javascript" src="./Love_files/love.js" charset="utf-8"></script>
</head>
<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    <div id="loading-screen">
        <div class="loading-heart"></div>
        <div class="loading-text">æ­£åœ¨å‡†å¤‡ç´ æ
            <span class="loading-dots">
                <span class="loading-dot">.</span>
                <span class="loading-dot">.</span>
                <span class="loading-dot">.</span>
            </span>
        </div>
        <div class="loading-progress">
            <div id="loading-progress-bar" class="loading-progress-bar"></div>
        </div>
        <div class="loading-tips" id="loading-tips">ç¬¬ä¸€æ¬¡å¹²è¿™ä¸ªï¼Œæœ‰ç‚¹ç´§å¼ ...</div>
    </div>

    <!-- é€‰æ‹©ç•Œé¢ -->
    <div id="container">
        <div class="container_inner">
            <div>
                <h4 style="margin-left:3px;text-align:center">å°å§å§æˆ‘è§‚å¯Ÿä½ å¥½ä¹…äº†ï¼ï¼ï¼</h4>
                <div>
                    <img id="image" src="./imgs/001.png" alt="" style="width:200px;height:200px;margin:0 auto;display:block">  
                </div>
            </div>
            <h4 style="text-align:center" id="duix">å¯ä»¥åšæˆ‘å¯¹è±¡å—ï¼Ÿ</h4>
            <div class="button_group">
                <button id="but_yes" class="but_common">å¯ä»¥</button>
                <button id="but_no" class="but_common">ä¸è¦</button>
            </div>
        </div>
    </div>
    
    <!-- è‡ªå®šä¹‰å¯¹è¯æ¡† -->
    <div id="customDialog" class="custom-dialog">
        <div class="dialog-content">
            <div class="dialog-message">å¤ªå¥½äº†ï¼Œæˆ‘ä»¬åœ¨ä¸€èµ·å§</div>
            <button id="dialogClose" class="dialog-button">ç¡®å®š</button>
        </div>
    </div>
    
    <!-- æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨ -->
    <audio id="bgMusic" preload="none">
        <source src="./imgs/bg_music.mp3" type="audio/mp3">
    </audio>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div id="musicControl" class="music-control">
        <i id="musicIcon" class="music-icon">ğŸµ</i>
    </div>
    
    <!-- å¿ƒå½¢åŠ¨ç”»å’ŒçƒŸèŠ±å®¹å™¨ -->
    <div id="effects" class="effects-container"></div>
    
    <!-- æƒ…ä¹¦åŠ¨ç”» -->
    <div id="main" style="display:none">
        <div id="error">äº²ï¼Œæ‚¨ä½¿ç”¨çš„æµè§ˆå™¨æ— æ³•æ”¯æŒå³å°†æ˜¾ç¤ºçš„å†…å®¹ï¼Œè¯·æ¢æˆè°·æ­Œ(<a href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-CN&brand=CHMI">Chrome</a>)æˆ–è€…ç«ç‹(<a href="http://firefox.com.cn/download/">Firefox</a>)æµè§ˆå™¨å“Ÿ~</div>
        <div id="wrap">
            <div id="text">
                <div id="code">
                    <span class="say">ä¸€å®šè¦çˆ±ä½ </span><br><br>
                    <span class="say">æˆ‘çŸ¥é“ä½ æ˜¯ä¸€ä¸ªå¤©çœŸå–„è‰¯æ¸©æŸ”çš„å¥³å­©</span><br>
                    <span class="say">çœŸçš„å¸Œæœ›è‡ªå·±èƒ½å¤Ÿé…ä¸Šä½ </span><br>
                    <span class="say">å¦‚æœä½ èƒ½ç»™æˆ‘æœºä¼šè®©æˆ‘å¥½å¥½çš„çˆ±ä½ </span><br>
                    <span class="say">çœŸçš„åªæƒ³çœŸå¿ƒçœŸæ„å¯¹ä½ è¯´</span><br>
                    <br>
                    <span class="say">æˆ‘çˆ±ä½ ä¸€å®šçˆ±åˆ°èŠ±éƒ½å¼€äº† é¸Ÿå„¿æŠŠæ­Œå”±</span><br>
                    <span class="say">çˆ±åˆ°ç‰›éƒç»‡å¥³ä¸ºæˆ‘ä»¬ç‚¹å¤´</span><br>
                    <span class="say">çˆ±åˆ°èŠ±å„¿ç»½æ”¾é¸Ÿå„¿æˆç¾¤ æŠŠæˆ‘ä»¬ç¯ç»•</span><br>
                    <span class="say">çˆ±åˆ°æ¯é“å½©è™¹æ˜ å‡ºä½ çš„ç¾</span><br>
                    <br>
                    <span class="say">æˆ‘çˆ±ä½ ä¸€å®šçˆ±åˆ°æµ·æ¯çŸ³çƒ‚ æ°¸è¿œä¸åæ‚”</span><br>
                    <span class="say">çˆ±åˆ°æ¥ç”Ÿæ¥ä¸–ä¹Ÿä¼šè¯´æ— æ‚”</span><br>
                    <span class="say">å°±æŠŠè¿™é¦–åŠ¨å¬çš„æ­Œå”±ç»™å¿ƒçˆ±çš„å¥³å­©</span><br>
                    <span class="say">çœŸçš„å¸Œæœ›ä½ èƒ½ç»™æˆ‘ä¸ªæœºä¼š</span><br>
                    <span class="say">è®©æˆ‘å»çˆ±ä½ </span><br>
                    <br>
                    <span class="say"><span class="space"></span> -- ä½ çš„ï¼Œå¤ªé˜³ã€‚</span>
                </div>
            </div>
            <div id="clock-box">
                <a href="https://sunguoqi.com" target="_blank">æ˜Ÿæ˜Ÿ</a> å’Œ <a href="https://sunguoqi.com" target="_blank">æœˆäº®</a> åœ¨ä¸€èµ·çš„
                <div id="clock"></div>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>
    </div>
    
    <script>
    // åŠ è½½åŠ¨ç”»
    const loadingScreen = document.getElementById('loading-screen');
    const loadingProgressBar = document.getElementById('loading-progress-bar');
    const loadingTips = document.getElementById('loading-tips');
    
    // æ·»åŠ éšè—çš„å¿«é€ŸåŠ è½½åŠŸèƒ½
    let quickLoadClickCount = 0;
    let lastClickTime = 0;
    const CLICK_TIMEOUT = 500; // 500æ¯«ç§’å†…çš„ç‚¹å‡»æ‰ç®—è¿ç»­ç‚¹å‡»
    
    // å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ ‡è®°ç”¨æˆ·æ˜¯å¦å·²äº¤äº’
    let userInteracted = false;
    // éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼Œç”¨äºæ£€æµ‹å’Œå¤„ç†éŸ³é¢‘æ’­æ”¾çŠ¶æ€
    let audioContext;

    // å°è¯•åœ¨ç”¨æˆ·é¦–æ¬¡äº¤äº’æ—¶æ’­æ”¾éŸ³ä¹
    function tryPlayMusic() {
        if (userInteracted) return; // å¦‚æœå·²ç»äº¤äº’è¿‡äº†ï¼Œä¸å†æ‰§è¡Œ
        
        userInteracted = true;
        const bgMusic = document.getElementById("bgMusic");
        
        // ç¡®ä¿éŸ³ä¹æºå·²è®¾ç½®
        if (!bgMusic.getAttribute('src')) {
            bgMusic.setAttribute('src', './imgs/bg_music.mp3');
        }
        
        // å°è¯•æ’­æ”¾
        bgMusic.play().then(() => {
            document.getElementById('musicIcon').textContent = 'ğŸµ';
            window.musicPlaying = true;
        }).catch(e => console.log('å°è¯•æ’­æ”¾éŸ³ä¹å¤±è´¥:', e));
    }
    
    // ç›‘å¬å„ç§ç”¨æˆ·äº¤äº’äº‹ä»¶ä»¥å¯åŠ¨éŸ³é¢‘
    document.addEventListener('click', tryPlayMusic, {once: true});
    document.addEventListener('touchstart', tryPlayMusic, {once: true});
    document.addEventListener('keydown', tryPlayMusic, {once: true});
    
    loadingScreen.addEventListener('click', (e) => {
        const currentTime = new Date().getTime();
        
        // å¦‚æœè·ç¦»ä¸Šæ¬¡ç‚¹å‡»è¶…è¿‡500æ¯«ç§’ï¼Œé‡ç½®è®¡æ•°
        if (currentTime - lastClickTime > CLICK_TIMEOUT) {
            quickLoadClickCount = 1;
        } else {
            quickLoadClickCount++;
        }
        
        lastClickTime = currentTime;

        // å¦‚æœè¿ç»­ç‚¹å‡»ä¸‰æ¬¡ï¼Œç›´æ¥å®ŒæˆåŠ è½½
        if (quickLoadClickCount >= 3) {
            // æ¸…é™¤æ‰€æœ‰å®šæ—¶å™¨
            clearInterval(tipInterval);
            clearInterval(loadingInterval);
            
            // ç›´æ¥å®ŒæˆåŠ è½½
            loadingProgressBar.style.width = '100%';
            
            // å»¶è¿Ÿä¸€å°æ®µæ—¶é—´åç§»é™¤åŠ è½½ç•Œé¢
            setTimeout(() => {
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }, 300);
        }
    });
    
    // åŠ è½½æç¤ºè¯­
    const loadingTipsArray = [
        "çŸ¥é“ä½ å³å°†é¢å¯¹ä»€ä¹ˆå˜›",
        "è¶ç°åœ¨è¿˜æ¥å¾—åŠï¼",
        "...",
        "å›¾ç‰‡å‡†å¤‡ä¸­...",
        "éŸ³ä¹åŠ è½½ä¸­...",
        "æ­£åœ¨å¯»æ‰¾æ‰¾å“äººç´ æ...",
        "æˆåŠŸç‡æ­£åœ¨è®¡ç®—...",
        "å‰æ–¹é«˜èƒ½ï¼ï¼ï¼",
        "3ï¼",
        "2ï¼ï¼",
        "1ï¼ï¼ï¼",
        "æ¥ä¸åŠäº†!",
        "å¿«è·‘!",
        ".",
        "..",
        "...",
        "å’¦ï¼Œè¿˜ä¸è·‘(à¹‘â€¢ÌŒ.â€¢Ì‘à¹‘)Ë€Ì£Ë€Ì£",
        "...",
        "ä½ è¿˜åœ¨é‚£å—...",
        "ä½ éš¾é“æ²¡æœ‰äº‹æƒ…è¦åšå—ï¼Ÿ",
        "ä»åˆšæ‰åˆ°ç°åœ¨ä¸€ç›´ç›¯ç€æˆ‘...",
        "æˆ‘çŸ¥é“äº†(ã€‚ãƒ»`Ï‰Â´ãƒ»)",
        "ä½ å–œæ¬¢æˆ‘(â—'â—¡'â—)",
        "ä½ è¯´ä»€ä¹ˆï¼Ÿ",
        "å¬ä¸æ‡‚â•®( â€¢ÌÏ‰â€¢Ì€ )â•­",
        "åœ¨è¿™å„¿æˆ‘è¯´äº†ç®—Æª(Ë˜âŒ£Ë˜)Êƒ",
        "å˜¿å˜¿o(*â‰§â–½â‰¦)ãƒ„ ~ â”´â”´",
    ];
    
    // é¡ºåºæ˜¾ç¤ºæç¤ºè¯­
    let tipIndex = 0;
    let minLoadingTime = loadingTipsArray.length * 930; // è‡³å°‘æ˜¾ç¤ºè¿™ä¹ˆé•¿æ—¶é—´ï¼ˆæ¯æ¡æç¤º1ç§’ï¼‰
    let startTime = Date.now();
    
    // é¡ºåºæ›´æ–°æç¤ºè¯­
    const tipInterval = setInterval(() => {
        loadingTips.textContent = loadingTipsArray[tipIndex];
        tipIndex++;
        // å¦‚æœå·²ç»æ˜¾ç¤ºå®Œæ‰€æœ‰æç¤ºè¯­ï¼Œé‡æ–°å¼€å§‹
        if (tipIndex >= loadingTipsArray.length) {
            tipIndex = 0;
        }
    }, 1000); // æ¯ç§’æ›´æ–°ä¸€æ¬¡æç¤ºè¯­
    
    // æ¨¡æ‹ŸåŠ è½½è¿›åº¦
    let progress = 0;
    const loadingInterval = setInterval(() => {
        // è®¡ç®—å·²ç»ç»è¿‡çš„æ—¶é—´
        const elapsedTime = Date.now() - startTime;
        
        // æ ¹æ®å·²ç»ç»è¿‡çš„æ—¶é—´è®¡ç®—è¿›åº¦æ¡æ¯”ä¾‹
        if (elapsedTime < minLoadingTime) {
            // å¦‚æœæ²¡åˆ°æœ€å°åŠ è½½æ—¶é—´ï¼Œç¼“æ…¢å¢åŠ è¿›åº¦ï¼Œç¡®ä¿ä¸ä¼šè¶…è¿‡95%
            progress = (elapsedTime / minLoadingTime) * 95;
        } else {
            // è¶…è¿‡æœ€å°æ—¶é—´åå¿«é€Ÿå®Œæˆå‰©ä½™è¿›åº¦
            progress += (100 - progress) / 10;
        }
        
        // å¦‚æœè¿›åº¦è¾¾åˆ°100%ï¼Œå®ŒæˆåŠ è½½
        if (progress >= 99.5) {
            progress = 100;
            clearInterval(loadingInterval);
            clearInterval(tipInterval);
            
            // å®ŒæˆåŠ è½½åæ·¡å‡ºåŠ è½½å±å¹•
            setTimeout(() => {
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }, 500);
        }
        
        // æ›´æ–°åŠ è½½è¿›åº¦æ¡
        loadingProgressBar.style.width = `${progress}%`;
    }, 100); // æ›´é¢‘ç¹åœ°æ›´æ–°è¿›åº¦æ¡ï¼Œä½¿å…¶æ›´æµç•…

    // å»¶è¿ŸåŠ è½½éå¿…è¦èµ„æº
    window.addEventListener('load', function() {
        // å›¾ç‰‡æ•°ç»„ - ä»…é¢„åŠ è½½é¦–å¼ å›¾ç‰‡ï¼Œå…¶ä»–å›¾ç‰‡å»¶è¿ŸåŠ è½½
        const dogImages = ['imgs/001.png', 'imgs/002.png', 'imgs/003.png', 'imgs/004.png', 'imgs/005.png'];
        // é¢„åŠ è½½å›¾ç‰‡èµ„æº
        setTimeout(() => {
            dogImages.forEach((src, index) => {
                if (index > 0) { // ç¬¬ä¸€å¼ å·²ç»åœ¨é¡µé¢ä¸­åŠ è½½äº†
                    const img = new Image();
                    img.src = src;
                }
            });
            // é¢„åŠ è½½ç»“æŸå›¾ç‰‡
            const endImg = new Image();
            endImg.src = 'imgs/ok.png';
        }, 2000); // 2ç§’åå¼€å§‹é¢„åŠ è½½å…¶ä»–å›¾ç‰‡

        // å­—ç¬¦æ•°ç»„
        const textImages = ['è¦ä¸å†æƒ³æƒ³ï¼Ÿ', 'ä½ è®¤çœŸçš„å—ï¼Ÿ', 'æˆ‘ä¼šä¼¤å¿ƒçš„...', 'ä¸å…è®¸é€‰è¿™ä¸ª'];
        
        // DOMå…ƒç´ å¼•ç”¨
        const image = document.getElementById('image');
        const changeBtn = document.getElementById("but_no");
        const yesBtn = document.getElementById("but_yes");
        const dx = document.getElementById("duix");
        const bgMusic = document.getElementById("bgMusic");
        const musicControl = document.getElementById("musicControl");
        const musicIcon = document.getElementById("musicIcon");
        const effectsContainer = document.getElementById("effects");
        const customDialog = document.getElementById('customDialog');
        const dialogClose = document.getElementById('dialogClose');

        // çŠ¶æ€å˜é‡
        let currentTextIndex = 0;
        let currentIndex = 0;
        let currentScale = 1; // è®°å½•æŒ‰é’®æ”¾å¤§æ¯”ä¾‹
        let clickCount = 0; // è®°å½•ç‚¹å‡»æ¬¡æ•°
        let musicPlaying = window.musicPlaying || false; // ä½¿ç”¨å…¨å±€çŠ¶æ€æˆ–è®¾ä¸ºfalse
        let timerId;

        // é¡µé¢åŠ è½½å®Œæˆåå‡†å¤‡èƒŒæ™¯éŸ³ä¹
        if (!bgMusic.getAttribute('src')) {
            bgMusic.setAttribute('src', './imgs/bg_music.mp3');
        }

        // å»¶è¿ŸåŠ è½½éŸ³ä¹æ§åˆ¶æŒ‰é’®äº‹ä»¶
        musicControl.addEventListener('click', function() {
            // ç¡®ä¿éŸ³ä¹æºå·²è®¾ç½®
            if (!bgMusic.getAttribute('src')) {
                bgMusic.setAttribute('src', './imgs/bg_music.mp3');
            }
            toggleMusic();
        });

        // æŒ‰é’®äº‹ä»¶ç»‘å®š - ä½¿ç”¨äº‹ä»¶å§”æ‰˜å‡å°‘äº‹ä»¶ç›‘å¬å™¨æ•°é‡
        changeBtn.addEventListener('click', handleNoClick);
        yesBtn.addEventListener('click', handleYesClick);
        dialogClose.addEventListener('click', () => customDialog.style.display = 'none');

        // "ä¸è¦"æŒ‰é’®ç‚¹å‡»å¤„ç†
        function handleNoClick() {
            // åˆ‡æ¢å›¾ç‰‡
            if (currentIndex < dogImages.length - 1) {
                currentIndex = (currentIndex + 1) % dogImages.length;
            }
            image.src = dogImages[currentIndex];

            // æ–‡å­—åˆ‡æ¢
            if (currentTextIndex < textImages.length - 1) {
                currentTextIndex = (currentTextIndex + 1) % textImages.length;
            }
            changeBtn.style.width = '100px';
            changeBtn.innerText = textImages[currentTextIndex];

            // æŒ‰é’®æ”¾å¤§æ•ˆæœ
            currentScale *= 1.5;
            yesBtn.style.width = `${yesBtn.offsetWidth * 1.5}px`;
            yesBtn.style.height = `${yesBtn.offsetHeight * 1.5}px`;
            yesBtn.style.fontSize = `${parseFloat(getComputedStyle(yesBtn).fontSize) * 1.5}px`;

            // ç»Ÿè®¡ç‚¹å‡»æ¬¡æ•°
            clickCount++;
            if (clickCount >= 5) {
                changeBtn.style.position = "absolute";
                changeBtn.style.transition = "top 0.3s, left 0.3s";
                changeBtn.style.pointerEvents = "none";
                startMoving();
            }
        }

        // "å¯ä»¥"æŒ‰é’®ç‚¹å‡»å¤„ç†
        function handleYesClick() {
            // æ˜¾ç¤ºè‡ªå®šä¹‰å¯¹è¯æ¡†
            customDialog.style.display = 'flex';
            
            clearInterval(timerId);
            yesBtn.style.pointerEvents = "none";
            changeBtn.style.pointerEvents = "none";
            
            // æ¢å¤"å¯ä»¥"æŒ‰é’®åˆ°æ­£å¸¸å¤§å°
            yesBtn.style.width = "65px";
            yesBtn.style.height = "30px";
            yesBtn.style.fontSize = "14px";
            
            // åŠ è½½å¹¶æ’­æ”¾æ¬¢ä¹éŸ³ä¹
            if(!bgMusic.getAttribute('src')) {
                bgMusic.setAttribute('src', './imgs/happy_music.mp3');
            } else {
                bgMusic.setAttribute('src', './imgs/happy_music.mp3');
            }
            
            bgMusic.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e));
            musicPlaying = true;
            musicIcon.textContent = 'ğŸµ';
            
            image.src = 'imgs/ok.png';
            dx.innerText = "å®å®äº²äº²";
            
            // ä¼˜åŒ–ç‰¹æ•ˆ - æ ¹æ®è®¾å¤‡æ€§èƒ½è°ƒæ•´æ•ˆæœ
            const isLowPerformance = window.navigator.connection && 
                (window.navigator.connection.effectiveType === 'slow-2g' || 
                 window.navigator.connection.effectiveType === '2g');
            
            createHeartAnimation(isLowPerformance);
            createFireworks(isLowPerformance);
            
            // æ˜¾ç¤ºæƒ…ä¹¦åŠ¨ç”»
            customDialog.style.display = 'none';
            document.getElementById('container').style.display = 'none';
            document.getElementById('main').style.display = 'block';
            
            // åˆå§‹åŒ–æƒ…ä¹¦åŠ¨ç”»
            startHeartAnimation();
        }

        function startMoving() {
            timerId = setInterval(() => {
                let maxX = window.innerWidth - changeBtn.offsetWidth - 800;
                let maxY = window.innerHeight - changeBtn.offsetHeight - 600;
                let newX = Math.random() * maxX;
                let newY = Math.random() * maxY;
                changeBtn.style.left = `${newX}px`;
                changeBtn.style.top = `${newY}px`;
            }, 200);
        }

        // åˆ›å»ºå¿ƒå½¢åŠ¨ç”» - ä¼˜åŒ–ç‰ˆ
        function createHeartAnimation(isLowPerformance) {
            const heartCount = isLowPerformance ? 15 : 40;
            const interval = isLowPerformance ? 250 : 150;
            
            for (let i = 0; i < heartCount; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
                    heart.style.animationDelay = (Math.random() * 5) + 's';
                    effectsContainer.appendChild(heart);
                    
                    setTimeout(() => heart.remove(), 8000);
                }, i * interval);
            }
        }

        // åˆ›å»ºçƒŸèŠ±æ•ˆæœ - ä¼˜åŒ–ç‰ˆ
        function createFireworks(isLowPerformance) {
            // æ ¹æ®ç½‘ç»œå’Œè®¾å¤‡æ€§èƒ½è°ƒæ•´çƒŸèŠ±æ•°é‡å’Œå¤æ‚åº¦
            const normalFireworkCount = isLowPerformance ? 10 : 25;
            const particleCount = isLowPerformance ? 15 : 30;
            const specialParticleCount = isLowPerformance ? 30 : 60;
            
            // å…ˆåˆ›å»ºæ™®é€šçƒŸèŠ±
            for (let i = 0; i < normalFireworkCount; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    const x = Math.random() * 80 + 10;
                    const y = Math.random() * 50 + 10;
                    firework.style.left = x + 'vw';
                    firework.style.top = y + 'vh';
                    
                    const colors = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    firework.style.setProperty('--firework-color', color);
                    
                    const size = Math.random() * 10 + 10;
                    firework.style.width = `${size}px`;
                    firework.style.height = `${size}px`;
                    
                    effectsContainer.appendChild(firework);
                    
                    setTimeout(() => {
                        for (let j = 0; j < particleCount; j++) {
                            const particle = document.createElement('div');
                            particle.className = 'particle';
                            particle.style.left = x + 'vw';
                            particle.style.top = y + 'vh';
                            particle.style.setProperty('--angle', j * (360/particleCount) + 'deg');
                            particle.style.setProperty('--particle-color', color);
                            
                            const particleSize = Math.random() * 4 + 4;
                            particle.style.width = `${particleSize}px`;
                            particle.style.height = `${particleSize}px`;
                            
                            effectsContainer.appendChild(particle);
                            
                            setTimeout(() => particle.remove(), 3000);
                        }
                        firework.remove();
                    }, 1000);
                }, i * 600);
            }

            // ç‰¹æ®ŠçƒŸèŠ±çš„æ—¶é—´é—´éš”
            const specialFireworkInterval = isLowPerformance ? 9000 : 6000;
            
            // å»¶è¿Ÿåˆ›å»ºç‰¹æ®ŠçƒŸèŠ±
            setTimeout(() => {
                createSpecialFirework(0, isLowPerformance, specialParticleCount);
                
                setTimeout(() => {
                    createSpecialFirework(1, isLowPerformance, specialParticleCount);
                    
                    setTimeout(() => {
                        createSpecialFirework(2, isLowPerformance, specialParticleCount);
                    }, specialFireworkInterval);
                }, specialFireworkInterval);
            }, 3000);
        }
        
        // åˆ›å»ºç‰¹æ®Šå¤§çƒŸèŠ± - ä¼˜åŒ–ç‰ˆ
        function createSpecialFirework(index, isLowPerformance, particleCount) {
            // æ ¹æ®ç´¢å¼•è®¾ç½®çƒŸèŠ±ä½ç½®
            let posX, posY;
            
            if (index === 0) {
                posX = '50vw';
                posY = '40vh';
            } else if (index === 1) {
                posX = '30vw';
                posY = '35vh';
            } else {
                posX = '70vw';
                posY = '35vh';
            }
            
            const firework = document.createElement('div');
            firework.className = 'firework special-firework';
            firework.style.left = posX;
            firework.style.top = posY;
            firework.style.width = '20px';
            firework.style.height = '20px';
            
            const colors = ['#ff5a8e', '#ff9500', '#00ff95', '#5a8eff'];
            const color = colors[index % colors.length];
            firework.style.backgroundColor = color;
            firework.style.boxShadow = `0 0 20px ${color}, 0 0 40px ${color}`;
            
            effectsContainer.appendChild(firework);
            
            // ä½å¸¦å®½æƒ…å†µä¸‹ä¸æ’­æ”¾éŸ³é¢‘
            if (!isLowPerformance) {
                // å»¶è¿ŸåŠ è½½éŸ³æ•ˆ
                const specialSound = new Audio();
                specialSound.volume = 0.5;
                specialSound.src = './imgs/firework_sound.mp3';
                specialSound.play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾å¤±è´¥:', e));
            }
            
            setTimeout(() => {
                firework.remove();
                
                const flash = document.createElement('div');
                flash.className = 'flash';
                flash.style.backgroundColor = `rgba(255, 255, 255, 0.6)`;
                effectsContainer.appendChild(flash);
                
                const messageContainer = document.createElement('div');
                messageContainer.className = 'message-container';
                
                const messages = [
                    ['ä½™ç”Ÿå¾ˆé•¿ï¼Œè¯·å¤šæŒ‡æ•™', 'æ‰§å­ä¹‹æ‰‹ï¼Œä¸å­å•è€', 'ä½ æ˜¯æˆ‘ä»Šç”Ÿæœ€ç¾çš„ç›¸é‡', 'æ„¿æœ‰å²æœˆå¯å›é¦–ï¼Œä¸”ä»¥æ·±æƒ…å…±ç™½å¤´'],
                    ['å¿ƒæœ‰æ‰€å±ï¼Œæ„Ÿè°¢ç›¸é‡', 'æ„¿æ‰§å­ä¹‹æ‰‹ï¼Œä¸å­å•è€', 'ä½ æ˜¯æˆ‘æœ€å¥½çš„ç¤¼ç‰©', 'é‡è§ä½ ï¼Œæ˜¯æˆ‘æœ€ç¾ä¸½çš„æ„å¤–'],
                    ['äººç”Ÿå¾ˆçŸ­ï¼Œé‡è§ä½ å¾ˆå¹¸è¿', 'æˆ‘è¦çš„ä¸å¤šï¼Œåªè¦ä½ ', 'æ„¿é™ªä½ èµ°è¿‡å››å­£ï¼Œèµå°½æ˜¥èŠ±ç§‹æœˆ', 'å¾€åä½™ç”Ÿï¼Œè¯·å¤šæŒ‡æ•™']
                ];
                
                const selectedMessages = messages[index % messages.length];
                const randomMessage = selectedMessages[Math.floor(Math.random() * selectedMessages.length)];
                
                messageContainer.textContent = randomMessage;
                messageContainer.style.color = color;
                messageContainer.style.textShadow = `0 0 10px ${color}`;
                messageContainer.style.left = posX;
                messageContainer.style.top = posY;
                effectsContainer.appendChild(messageContainer);
                
                // åˆ›å»ºç²’å­æ•ˆæœ
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'special-particle';
                    particle.style.left = posX;
                    particle.style.top = posY;
                    
                    const angle = (i * (360/particleCount)) + Math.random() * 5;
                    const distance = 150 + Math.random() * 50;
                    
                    const particleColors = [color, '#ffffff', '#ffff00', '#ff00ff'];
                    const particleColor = particleColors[Math.floor(Math.random() * particleColors.length)];
                    particle.style.backgroundColor = particleColor;
                    
                    const size = Math.random() * 6 + 6;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    
                    particle.style.setProperty('--angle', angle + 'deg');
                    particle.style.setProperty('--distance', distance + 'px');
                    
                    effectsContainer.appendChild(particle);
                }
                
                setTimeout(() => {
                    messageContainer.style.opacity = '0';
                    setTimeout(() => messageContainer.remove(), 1000);
                }, 4000);
                
                flash.remove();
            }, 1200);
        }

        // åˆ‡æ¢éŸ³ä¹æ’­æ”¾çŠ¶æ€
        function toggleMusic() {
            if (musicPlaying) {
                bgMusic.pause();
                musicIcon.textContent = 'ğŸ”‡';
            } else {
                if (bgMusic.muted) {
                    bgMusic.muted = false;
                }
                bgMusic.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e));
                musicIcon.textContent = 'ğŸµ';
            }
            musicPlaying = !musicPlaying;
        }
    });
    
    // æƒ…ä¹¦åŠ¨ç”»åˆå§‹åŒ–å‡½æ•°
    function startHeartAnimation() {
        var canvas = $('#canvas');
        if (!canvas[0].getContext) {
            $("#error").show();
            return false;
        }

        var width = canvas.width();
        var height = canvas.height();

        canvas.attr("width", width);
        canvas.attr("height", height);

        var opts = {
            seed: {
                x: width / 2 - 20,
                color: "rgb(190, 26, 37)",
                scale: 2
            },
            branch: [
                [535, 680, 570, 250, 500, 200, 30, 100, [
                    [540, 500, 455, 417, 340, 400, 13, 100, [
                        [450, 435, 434, 430, 394, 395, 2, 40]
                    ]],
                    [550, 445, 600, 356, 680, 345, 12, 100, [
                        [578, 400, 648, 409, 661, 426, 3, 80]
                    ]],
                    [539, 281, 537, 248, 534, 217, 3, 40],
                    [546, 397, 413, 247, 328, 244, 9, 80, [
                        [427, 286, 383, 253, 371, 205, 2, 40],
                        [498, 345, 435, 315, 395, 330, 4, 60]
                    ]],
                    [546, 357, 608, 252, 678, 221, 6, 100, [
                        [590, 293, 646, 277, 648, 271, 2, 80]
                    ]]
                ]]
            ],
            bloom: {
                num: 700,
                width: 1080,
                height: 650,
            },
            footer: {
                width: 1200,
                height: 5,
                speed: 10,
            }
        }

        var tree = new Tree(canvas[0], width, height, opts);
        var seed = tree.seed;
        var foot = tree.footer;
        var hold = 1;

        canvas.off("click").off("mousemove");
        canvas.click(function (e) {
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            if (seed.hover(x, y)) {
                hold = 0;
                canvas.unbind("click");
                canvas.unbind("mousemove");
                canvas.removeClass('hand');
            }
        }).mousemove(function (e) {
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            canvas.toggleClass('hand', seed.hover(x, y));
        });

        var seedAnimate = eval(Jscex.compile("async", function () {
            seed.draw();
            while (hold) {
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canScale()) {
                seed.scale(0.95);
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canMove()) {
                seed.move(0, 2);
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
        }));

        var growAnimate = eval(Jscex.compile("async", function () {
            do {
                tree.grow();
                $await(Jscex.Async.sleep(10));
            } while (tree.canGrow());
        }));

        var flowAnimate = eval(Jscex.compile("async", function () {
            do {
                tree.flower(2);
                $await(Jscex.Async.sleep(10));
            } while (tree.canFlower());
        }));

        var moveAnimate = eval(Jscex.compile("async", function () {
            tree.snapshot("p1", 240, 0, 610, 680);
            while (tree.move("p1", 500, 0)) {
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
            foot.draw();
            tree.snapshot("p2", 500, 0, 610, 680);

            // ä¼šæœ‰é—ªçƒä¸å¾—æ„è¿™æ ·åš, (ï¼ï¹ï¼œ)
            canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
            canvas.css("background", "#ffc0cb");
            $await(Jscex.Async.sleep(300));
            canvas.css("background", "none");
        }));

        var jumpAnimate = eval(Jscex.compile("async", function () {
            var ctx = tree.ctx;
            while (true) {
                tree.ctx.clearRect(0, 0, width, height);
                tree.jump();
                foot.draw();
                $await(Jscex.Async.sleep(25));
            }
        }));

        var textAnimate = eval(Jscex.compile("async", function () {
            var together = new Date();
            together.setFullYear(2001, 2, 25);
            together.setHours(0);
            together.setMinutes(0);
            together.setSeconds(0);
            together.setMilliseconds(0);

            $("#code").show().typewriter();
            $("#clock-box").fadeIn(500);
            while (true) {
                timeElapse(together);
                $await(Jscex.Async.sleep(1000));
            }
        }));

        var runAsync = eval(Jscex.compile("async", function () {
            $await(seedAnimate());
            $await(growAnimate());
            $await(flowAnimate());
            $await(moveAnimate());

            textAnimate().start();

            $await(jumpAnimate());
        }));

        runAsync().start();
    }
    </script>
</body>
</html>
